/*
 * nLoader
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2, as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA.
 */

int patch_Boot2();

#define	RSAOS_CXPROD	\
	0x69f44fa5,	0x4d8cfe58,	0x6c5608a9,	0x69403080,	0x5f4cb854,	0x2f288a17,	0x741344e3,	0x9aec7712,\
	0x604d933c,	0x102c5c44,	0x2a5859cb,	0x8f1d3fea,	0x6f0406d6,	0x38045e8c,	0x318579a8,	0x22a936cf,\
	0x7e0c011a,	0x3d621e18,	0xc26dd827,	0x2c568bc6,	0xa239fd81,	0xd9312a4e,	0xe69a0230,	0x4e546eaa,\
	0xbcec173c,	0x56e04fe9,	0x457501a,	0x9bf97d19,	0x77378a00,	0x6c3aacee,	0x557805fa,	0xbed3fd7,\
	0x7c380a72,	0x88d14c74,	0x45846d3,	0x69d282f0,	0x250fffc0,	0xdd926ed3,	0xef8d77a6,	0x497edd2d,\
	0xa4caa0cb,	0x882397b2,	0x7272b96c,	0x8a7255a7,	0x41af1775,	0x101c6b1e,	0xdb47f481,	0xbe3e4769,\
	0xba342f6f,	0xa79b766f,	0x49135e8a,	0x4c6f3510,	0x4813413a,	0x5815429c,	0xc0decf6a,	0xccff3aab,\
	0x1dae3fc7,	0x948131b2,	0x99a0de7c,	0x4eb6f2e7,	0xc2f1def7,	0xffcdb8d0,	0xf14c7f87,	0xdbb6b4ec

#define	RSAOS_CXDVT	\
	0xb6feaba,	0x58d55187,	0xc37bef85,	0xd740a887,	0x1f0bd6ac,	0x2a4101c0,	0x1c968115,	0x1e429041,\
	0xad7d5e90,	0x6f878661,	0x8f128fb7,	0x7cc9c689,	0x26ea2dff,	0xc148f253,	0x5c67dbe9,	0x8f71a67,\
	0x705cee84,	0x2ce4707c,	0x23555a8d,	0xde23837,	0xb8d778fa,	0xcc562da,	0x39c85019,	0x7d595aea,\
	0x8e238e56,	0x637b6d68,	0xd56ac675,	0x8e09dcf8,	0x982d3609,	0xda7bf305,	0x236703c3,	0xa455dadf,\
	0x4a4cccc8,	0x7753af6b,	0x35b77f,	0xdbf3b464,	0x56fbe2be,	0x73e97f3b,	0x7bda9c66,	0x12ebfff1,\
	0x315ef01a,	0xfbf6076a,	0x9194b997,	0x58dba70,	0x32565171,	0xa43fe836,	0x3f2a9bd2,	0x76273a0f,\
	0xe995f07f,	0xdc0eaa09,	0xeb84fa7,	0x3d00a207,	0x8cd0525d,	0xad9de09d,	0x868fdec5,	0xeb855218,\
	0xa4c26528,	0x297c150a,	0x15fcecdd,	0x78815d8d,	0xd15c474a,	0xeaebfd06,	0xfc1cebf8,	0x7f844eef

#define	RSAOS_CMPROD	\
	0x4a99c1d3,	0x3366195b,	0xe04a74fd,	0x42a548c6,	0x729c4968,	0x295799e2,	0x3f1ef004,	0xb86808be,\
	0x9038f0e1,	0xbf5d4c50,	0xd76be81b,	0x5c5d0e2d,	0xd784ffe3,	0xdb968a76,	0x5310a92f,	0x93b5242a,\
	0xf122c160,	0x10979bd7,	0xe8d461e5,	0xedcfc6fe,	0x1bcf7b37,	0xec9181c1,	0xdf9f9c13,	0xfbd1870b,\
	0xe86a7552,	0x41c617c1,	0x39a569a2,	0x63fd9753,	0x840680e0,	0x1f6acad5,	0x7a260802,	0xb5a40779,\
	0x1aa0357d,	0x8e0a5baa,	0x54a28839,	0xaf69835c,	0xb6f787e2,	0xd081cd41,	0xcf170149,	0x431e6678,\
	0xffc01345,	0xa0fd3f0f,	0x5df1cd1f,	0x8d291b8d,	0x66e445e3,	0x5814a38,	0xa9f3f584,	0x9bbd685,\
	0xe6116bbe,	0x49600b04,	0x50a38ef2,	0x3f6e20d6,	0xd8f4f30b,	0x78b925a2,	0x265d0f51,	0x29b408c8,\
	0x89a4cfd0,	0xbb9b2e67,	0x6ff05d9e,	0xd0842a66,	0x6f2ada8e,	0x7acf652d,	0xfd3a9ea3,	0x61bdfa2b

// Boot2 ID = value at offset 0x20
#define CXB300_0	0x118205D0
#define CXB310_16	0x1189B110
#define CXB391_34	0x1189B840
#define CMB310_0	0x1189B9B0
#define CXB301_131	0x1189B9D0
#define CMB310_16	0x1189BA20
#define CXB302_141	0x1189BAA0
#define CXB324_7	0x1189BDD0
#define CXB402_47	0x1189BD70
#define CXB403_49	0x1189BE30
#define CXB430_X	0x1189BE80
#define CXB440_8	0x1189BEA0
#define CXB450_14	0x1189BEC0

/* patch nBoot for Boot2 < 4.0.1
- look for 
08 C0 85 E2 44 58 94 E5 03 00 9C E8 14 20 87 E2 01 00 55 E3 03 00 82 E8 10 50 8D E5 01 10 05 E2 01 20 A0 E3 08 30 87 E2 E7 FF FF 3A 00 00 51 E3 07 00 00 0A 08 20 8C E2 03 00 92 E8 02 20 A0 E3 1C E0 87 E2 02 00 55 E1 03 00 8E E8 08 30 83 E2 DD FF FF 3A 82 41 8C E0 03 00 94 E8 01 20 82 E2 82 E1 8C E0 14 40 83 E2 03 00 84 E8 03 00 9E E8 01 20 82 E2 1C E0 83 E2 02 00 55 E1 03 00 8E E8 10 30 83 E2
F2 FF FF 2A CF FF FF EA
- replace F2 FF FF 2A by 00 00 00 00
*/
#define NBOOT_CXB310_16		0x118B755C
#define NBOOT_CMB310_0		0x118B75B4
#define NBOOT_CXB301_131	0x118B75F8
#define NBOOT_CMB310_16		0x118B76A4
#define NBOOT_CXB302_141	0x118B7748
#define NBOOT_CXB324_7		0x118B8524
#define NBOOT_CXB391_34		0x118B8764
#define NBOOT_CXB300_0		0x118BB558

// used TI-Nspire.cer RSA key
// CM all : 30 82 01 0A 02 82 01 01 00 D3 C1
#define OSRSAD3_CMB310_0		0x118D89A9
#define OSRSAD3_CMB310_16		0x118DABD1
// CX prod: 30 82 01 0A 02 82 01 01 00 A5 4F
#define OSRSAA5_CXB301_131	0x118D8AA5
#define OSRSAA5_CXB302_141	0x118D8CFD
#define OSRSAA5_CXB310_16	0x118DA319
#define OSRSAA5_CXB324_7	0x118DCBF5
#define OSRSAA5_CXB391_34	0x118E3B0D
#define OSRSAA5_CXB402_47	0x118EDAA9
#define OSRSAA5_CXB403_49	0x118EDD1D
#define OSRSAA5_CXB430_5	0x118F2081
#define OSRSAA5_CXB430_3	0x118F20D1
#define OSRSAA5_CXB440_8	0x118F21B9
#define OSRSAA5_CXB450_14	0x118F2300
// CX devt: 30 82 01 0A 02 82 01 01 00 BA EA
#define OSRSABA_CXB300_0	0x11913071

// unused TI-Nspire.cer RSA key
// CX devt: 30 82 01 0A 02 82 01 01 00 BA EA
#define OSRSABA_CMB310_0	0x118D8259
#define OSRSABA_CXB301_131	0x118D8355
#define OSRSABA_CXB302_141	0x118D85AD
#define OSRSABA_CXB310_16	0x118D99CD
#define OSRSABA_CMB310_16	0x118DA285
#define OSRSABA_CXB324_7	0x118DC2A9
#define OSRSABA_CXB391_34	0x118E31C1
#define OSRSABA_CXB402_47	0x118ECEED
#define OSRSABA_CXB403_49	0x118ED161
#define OSRSABA_CXB430_5	0x118F14C5
#define OSRSABA_CXB430_3	0x118F1515
#define OSRSABA_CXB440_8	0x118F15FD
#define OSRSABA_CXB450_14	0x118F1744
// CX prod: 30 82 01 0A 02 82 01 01 00 A5 4F
#define OSRSAA5_CXB300_0	0x11913681

// asic :	2C 00 8D E5 01 00 A0 E3 28 50 93 E5 2C 40 93 E5
// mask :  	FF 00 FF FF FF FF FF FF FF FF FF FF FF FF FF FF
// 1st 0x34 a little before this
#define ASIC_CXB310_16		0x118B7CF9 // bad
#define ASIC_CXB301_131		0x118B7D9D
#define ASIC_CXB302_141		0x118B7EED
#define ASIC_CXB402_47		0x118B8855
#define ASIC_CXB403_49		0x118B8915
#define ASIC_CXB450_14		0x118B89B5
#define ASIC_CXB430_5		0x118B89FD
#define ASIC_CXB430_3		0x118B8A05
#define ASIC_CXB440_8		0x118B8A1D
#define ASIC_CXB324_7		0x118B8CC9
#define ASIC_CXB391_34		0x118B8F09
#define ASIC_CXB300_0		0x118BBC91

// manuf : B1 00 95 E1 60
#define MANUF_CMB310_0		0x118b87dc
#define MANUF_CMB310_16		0x118b88cc
#define MANUF_CXB310_16		0x118b8998
#define MANUF_CXB301_131	0x118b8a90
#define MANUF_CXB302_141	0x118b8be0
#define MANUF_CXB402_47		0x118b90ac
#define MANUF_CXB403_49		0x118b916c
#define MANUF_CXB450_14		0x118b920c
#define MANUF_CXB430_5		0x118b9254
#define MANUF_CXB430_3		0x118b925c
#define MANUF_CXB440_8		0x118b9274
#define MANUF_CXB324_7		0x118b9940
#define MANUF_CXB391_34		0x118b9b0c
#define MANUF_CXB300_0		0x118bc93c	

// version : write breakpoint to 0xA4012EB4
#define VER_CXB403_49		0x1187E0EC
#define VER_CXB440_8		0x1187E0EC
#define VER_CXB450_14		0x1187E0EC
